---
title: "task22"
author: "Milda Pieškutė"
date: '2016 m gruodis 15 d '
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(MASS)
```

## Multikolinearumas

1. Sugeneruokite atsitiktinių dydžių vektorius $n=100,  x_1, x_2$ ir $\varepsilon$ iš populiacijos su tokiomis charakteristikomis:
 $var(x_1)=5, var(x_2)=5, cor(x_1, x_2)=0.9 , var(\varepsilon)=1$
Tuomet sugeneruokite $y$ pagal tokią lygtį:
$y = 1 + 2 x_1 + 3 x_2 + \varepsilon$

```{r }
n=100

Sigma <- matrix(c(5, 0.9*5, 0.9*5, 5), 2, 2)

rawvars <- mvrnorm(n, mu=rep(0,2), Sigma)

cor(rawvars) # tikriname, ar koreliacija tokia, kokios reikia
var(rawvars) # tikriname, ar dispersija tokia, kokios reikia 


x_1<-rawvars[,1]
x_2<-rawvars[,2]

e<-rnorm(n, sd=1)

y=1+2*x_1+3*x_2+e 
```

2. Įvertinkite tiesinę regresiją su `lm` funkciją ir išsaugokite įvertintus koeficientus.

```{r }
lm1<-lm(y~x_1+x_2)
coef<-lm1$coefficients

```

3. Kartokite 1. ir 2. žingsnius 1000 kartų. Tuomet, gaukite įverčių vidurkius ir standartinį nuokrypį. Taip pat išbrėžkite gautų koeficientų tankio grafikus.

```{r }

coef<-matrix(0, nrow = 1000, ncol=3)
for (i in 1:1000) {

Sigma <- matrix(c(5, 0.9*5, 0.9*5, 5), 2, 2)
rawvars <- mvrnorm(n, mu=rep(0,2), Sigma)

x_1<-rawvars[,1]
x_2<-rawvars[,2]
e<-rnorm(n, sd=1)
y=1+2*x_1+3*x_2+e 

lm1<-lm(y~x_1+x_2)
coef[i,]<-lm1$coefficients
}

mean(coef[,1]) # intercept 
mean(coef[,2]) # x_1
mean(coef[,3]) # x_2

sd1<-sd(coef[,1])
sd2<-sd(coef[,2])
sd3<-sd(coef[,3])
sd1 #intercept
sd2 #x_1
sd3 #x_2

d1<-density(coef[,1])
d2<-density(coef[,2])
d3<-density(coef[,3])
plot(d1)
plot(d2)
plot(d3)
```

4. Dar kartą atlikite 1. punktą. Tuomet įvertinę tiesinę regresiją pažiūrėkite modelio `summary`. Prie koeficientų įverčių yra įvertinta ir jų standartinė paklaida. Palyginkite ją su 3-čiame punkte gautais standartiniais nuokrypiais. Pakomentuokite gautus rezultatus.

```{r }

Sigma <- matrix(c(5, 0.9*5, 0.9*5, 5), 2, 2)

rawvars <- mvrnorm(n=100, mu=rep(0,2), Sigma)

x_1<-rawvars[,1]
x_2<-rawvars[,2]

e<-rnorm(n, sd=1)

y=1+2*x_1+3*x_2+e

lm1<-lm(y~x_1+x_2)
summary(lm1)

sd1;sd2;sd3
```


Standartinė paklaida yra arti standartinių nuokrypių.


## Literatūra

http://www.statmethods.net/graphs/density.html
http://stats.stackexchange.com/questions/83172/generate-two-variables-with-precise-pre-specified-correlation